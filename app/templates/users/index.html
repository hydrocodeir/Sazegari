{% extends "base.html" %}
{% block content %}
<h1>کاربران</h1>

<div class="card">
  <h3>ایجاد کاربر جدید</h3>
  <form hx-post="/users" hx-target="#users-tbody" hx-swap="afterbegin" id="createUserForm">
    <label>نام و نام خانوادگی</label>
    <input name="full_name" required>

    <label>نام کاربری</label>
    <input name="username" required>

    <label>رمز عبور</label>
    <input name="password" type="password" required>

    <label>نقش</label>
    <select name="role" required>
      {% for r in roles %}
        <option value="{{ r }}">{{ r }}</option>
      {% endfor %}
    </select>

    <label>ارگان (برای نقش‌های استانی/شهرستانی)</label>
    <select name="org_id">
      <option value="">--</option>
      {% for o in orgs %}
        <option value="{{ o.id }}">{{ o.name }}</option>
      {% endfor %}
    </select>

    <label>شهرستان (برای نقش‌های شهرستانی)</label>
    <select name="county_id">
      <option value="">--</option>
      {% for c in counties %}
        <option value="{{ c.id }}">{{ c.name }}</option>
      {% endfor %}
    </select>

    <button type="submit">ایجاد</button>
    <p class="muted">نکته: برای نقش‌های شهرستانی حتماً ارگان+شهرستان را تعیین کنید؛ برای نقش‌های استانی فقط ارگان.</p>
  </form>

  <div id="user-create-error"></div>
</div>

<table>
  <thead>
    <tr>
      <th>#</th><th>نام</th><th>نام کاربری</th><th>نقش</th><th>org_id</th><th>county_id</th><th></th>
    </tr>
  </thead>
  <tbody id="users-tbody">
    {% for u in users %}
      {% include "users/_row.html" %}
    {% endfor %}
  </tbody>
</table>
{% endblock %}
