{% extends "base.html" %}
{% block page_title %}کاربران{% endblock %}
{% block content %}

<div class="row g-3">
  <div class="col-lg-4">
    <div class="card p-3 border-0 shadow-sm hover-lift">
      <h5 class="mb-2">ایجاد کاربر جدید</h5>
      <form hx-post="/users" hx-target="#users-tbody" hx-swap="afterbegin" class="vstack gap-2" id="createUserForm">
        <input class="form-control" name="full_name" placeholder="نام کامل" required>
        <input class="form-control" name="username" placeholder="نام کاربری" required>
        <input class="form-control" name="password" placeholder="رمز عبور" type="password" required>

        <select class="form-select" name="role" required>
          <option value="">-- نقش --</option>
          {% for r in roles %}
            <option value="{{ r }}">{{ r }}</option>
          {% endfor %}
        </select>

        <select class="form-select" name="org_id">
          <option value="">-- ارگان (اختیاری/وابسته به نقش) --</option>
          {% for o in orgs %}
            <option value="{{ o.id }}">{{ o.name }}</option>
          {% endfor %}
        </select>

        <select class="form-select" name="county_id">
          <option value="">-- شهرستان (اختیاری/وابسته به نقش) --</option>
          {% for c in counties %}
            <option value="{{ c.id }}">{{ c.name }}</option>
          {% endfor %}
        </select>

        <button class="btn btn-primary" type="submit">ایجاد</button>
      </form>
      <div class="small text-muted mt-2">مدیریت کاربران فقط برای مدیر دبیرخانه فعال است.</div>
    </div>
  </div>

  <div class="col-lg-8">
    <div class="card p-3 border-0 shadow-sm hover-lift">
      <div class="d-flex justify-content-between align-items-center mb-2">
        <h5 class="m-0">لیست کاربران</h5>
        <span class="text-muted small">{{ users|length }} مورد</span>
      </div>

      <div class="table-responsive">
        <table class="table table-sm align-middle" data-paginate="true" data-page-size="5">
          <thead>
            <tr>
              <th>#</th>
              <th>نام</th>
              <th>نام کاربری</th>
              <th>نقش</th>
              <th>ارگان</th>
              <th>شهرستان</th>
              <th>وضعیت</th>
              <th class="text-end"></th>
            </tr>
          </thead>
          <tbody id="users-tbody">
            {% for u in users %}
              {% include "users/_row.html" %}
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

{% endblock %}
